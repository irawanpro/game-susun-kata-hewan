
<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Sambung Garis</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    background: #222;
    overflow: hidden;
    height: 100%;
    touch-action: none;
  }
  #gameCanvas {
    display: block;
    background: #fff;
  }
  #overlay {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.9);
    color: #fff;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    font-family: sans-serif;
    z-index: 10;
  }
  button {
    margin-top: 20px;
    padding: 10px 20px;
    font-size: 18px;
  }
</style>
</head>
<body>

<canvas id="gameCanvas"></canvas>

<div id="overlay">
  <h1>Instruksi Bermain</h1>
  <p>Hubungkan semua titik menjadi satu garis tanpa terputus.</p>
  <p>Created by : GlowandGrow<br>
     Contact person : +6289629065679 / Rahma</p>
  <button id="startBtn">Mulai Game</button>
</div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
let points = [];
let visited = [];
let lines = [];
let currentLevel = 0;

const levels = [
  // 20 level koordinat relatif (0-1)
  [{x:0.2,y:0.2},{x:0.8,y:0.2},{x:0.8,y:0.8},{x:0.2,y:0.8}], // persegi
  [{x:0.5,y:0.2},{x:0.8,y:0.8},{x:0.2,y:0.8}], // segitiga
  [{x:0.2,y:0.2},{x:0.8,y:0.4},{x:0.2,y:0.6},{x:0.8,y:0.8}], // zigzag
  [{x:0.5,y:0.2},{x:0.65,y:0.3},{x:0.8,y:0.5},{x:0.65,y:0.7},{x:0.5,y:0.8},{x:0.35,y:0.7},{x:0.2,y:0.5},{x:0.35,y:0.3}], // lingkaran sederhana
  [{x:0.5,y:0.2},{x:0.6,y:0.5},{x:0.8,y:0.5},{x:0.65,y:0.65},{x:0.7,y:0.85},{x:0.5,y:0.72},{x:0.3,y:0.85},{x:0.35,y:0.65},{x:0.2,y:0.5},{x:0.4,y:0.5}], // bintang sederhana
  // sisanya bentuk variasi
  [{x:0.2,y:0.2},{x:0.5,y:0.2},{x:0.8,y:0.2},{x:0.8,y:0.5},{x:0.8,y:0.8},{x:0.5,y:0.8},{x:0.2,y:0.8},{x:0.2,y:0.5}],
  [{x:0.3,y:0.3},{x:0.7,y:0.3},{x:0.7,y:0.7},{x:0.3,y:0.7}],
  [{x:0.1,y:0.5},{x:0.5,y:0.1},{x:0.9,y:0.5},{x:0.5,y:0.9}],
  [{x:0.2,y:0.4},{x:0.4,y:0.2},{x:0.6,y:0.2},{x:0.8,y:0.4},{x:0.8,y:0.6},{x:0.6,y:0.8},{x:0.4,y:0.8},{x:0.2,y:0.6}],
  [{x:0.5,y:0.1},{x:0.9,y:0.5},{x:0.5,y:0.9},{x:0.1,y:0.5}],
  [{x:0.3,y:0.3},{x:0.7,y:0.3},{x:0.7,y:0.7},{x:0.3,y:0.7},{x:0.5,y:0.5}],
  [{x:0.2,y:0.2},{x:0.8,y:0.2},{x:0.8,y:0.8},{x:0.2,y:0.8},{x:0.5,y:0.5}],
  [{x:0.25,y:0.25},{x:0.75,y:0.25},{x:0.75,y:0.75},{x:0.25,y:0.75}],
  [{x:0.15,y:0.15},{x:0.85,y:0.15},{x:0.85,y:0.85},{x:0.15,y:0.85}],
  [{x:0.5,y:0.2},{x:0.7,y:0.4},{x:0.5,y:0.6},{x:0.3,y:0.4}],
  [{x:0.2,y:0.3},{x:0.8,y:0.3},{x:0.8,y:0.7},{x:0.2,y:0.7}],
  [{x:0.4,y:0.4},{x:0.6,y:0.4},{x:0.6,y:0.6},{x:0.4,y:0.6}],
  [{x:0.3,y:0.5},{x:0.5,y:0.3},{x:0.7,y:0.5},{x:0.5,y:0.7}],
  [{x:0.25,y:0.25},{x:0.75,y:0.25},{x:0.75,y:0.75},{x:0.25,y:0.75},{x:0.5,y:0.5}],
  [{x:0.1,y:0.1},{x:0.9,y:0.1},{x:0.9,y:0.9},{x:0.1,y:0.9}]
];

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  draw();
}

function scalePoints(level) {
  return level.map(p => ({
    x: p.x * canvas.width,
    y: p.y * canvas.height
  }));
}

function loadLevel(idx) {
  points = scalePoints(levels[idx]);
  visited = [];
  lines = [];
  draw();
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = "#000";
  ctx.font = "20px sans-serif";
  ctx.fillText(`Level ${currentLevel+1} / ${levels.length}`, 10, 30);

  ctx.strokeStyle = "blue";
  ctx.lineWidth = 3;
  ctx.beginPath();
  for (let line of lines) {
    ctx.moveTo(line[0].x, line[0].y);
    ctx.lineTo(line[1].x, line[1].y);
  }
  ctx.stroke();

  points.forEach((p,i) => {
    ctx.beginPath();
    ctx.arc(p.x, p.y, 10, 0, Math.PI*2);
    ctx.fillStyle = visited.includes(i) ? "green" : "red";
    ctx.fill();
  });
}

let isDrawing = false;
let lastPoint = null;

canvas.addEventListener('touchstart', e => {
  e.preventDefault();
  const t = e.touches[0];
  const idx = getPointIndex(t.clientX, t.clientY);
  if (idx !== -1) {
    isDrawing = true;
    visited.push(idx);
    lastPoint = points[idx];
    draw();
  }
});

canvas.addEventListener('touchmove', e => {
  e.preventDefault();
  if (!isDrawing) return;
  const t = e.touches[0];
  const idx = getPointIndex(t.clientX, t.clientY);
  if (idx !== -1 && !visited.includes(idx)) {
    lines.push([lastPoint, points[idx]]);
    visited.push(idx);
    lastPoint = points[idx];
    draw();
    if (visited.length === points.length) {
      setTimeout(nextLevel, 1000);
    }
  }
});

canvas.addEventListener('touchend', () => {
  isDrawing = false;
  lastPoint = null;
});

function getPointIndex(x, y) {
  return points.findIndex(p => Math.hypot(p.x - x, p.y - y) < 15);
}

function nextLevel() {
  currentLevel++;
  if (currentLevel >= levels.length) {
    alert("Selamat! Semua pola selesai.");
    currentLevel = 0;
  }
  loadLevel(currentLevel);
}

window.addEventListener('resize', () => {
  setTimeout(resizeCanvas, 200);
});
window.addEventListener('orientationchange', () => {
  setTimeout(resizeCanvas, 200);
});

document.getElementById('startBtn').addEventListener('click', async () => {
  document.getElementById('overlay').style.display = 'none';
  if (canvas.requestFullscreen) await canvas.requestFullscreen();
  if (screen.orientation && screen.orientation.lock) {
    try { await screen.orientation.lock('landscape'); } catch(e){}
  }
  resizeCanvas();
  loadLevel(currentLevel);
});
</script>

</body>
  </html>
