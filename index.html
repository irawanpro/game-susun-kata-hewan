
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tebak Suara Huruf!üî†‚ú¥Ô∏è</title>
    <style>
        /* Desain Umum dan Font */
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One&family=Open+Sans:wght@400;700&display=swap');

        /* Perubahan utama: flexbox dan zoom-out 80% */
        html, body {
            width: calc(100% / 0.9); /* Menyesuaikan lebar agar pas setelah di-zoom */
            height: 100%;
            margin: 0;
            padding: 0;
            transform-origin: top left;
            transform: scale(0.9);
            font-family: 'Open Sans', sans-serif;
            background: url('assets/audio/background.jpg') no-repeat center center fixed;
            background-size: cover;
            color: #333;
        }
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: calc(100vh / 0.9); /* Menyesuaikan tinggi agar pas di tengah */
            overflow: hidden; /* MEMATIKAN FUNGSI SCROLLING */
        }
        .game-container {
            background-color: rgba(255, 255, 255, 0.85);
            border-radius: 25px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            padding: 40px;
            text-align: center;
            max-width: 650px;
            width: 90%;
            transform: scale(0.95);
            animation: bounceIn 0.8s ease-out forwards;
            position: relative;
            overflow: hidden;
            border: 5px solid #FF6347;
            box-sizing: border-box;
        }

        /* --- Gaya CSS Lainnya tetap sama seperti aslinya --- */
        @keyframes bounceIn {
            0% { transform: scale(0.5); opacity: 0; }
            70% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(1); }
        }

        .game-container::before, .game-container::after {
            content: '';
            position: absolute;
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            filter: blur(20px);
            z-index: 0;
        }

        .game-container::before {
            width: 150px;
            height: 150px;
            top: -50px;
            left: -50px;
        }

        .game-container::after {
            width: 100px;
            height: 100px;
            bottom: -30px;
            right: -30px;
        }

        h1 {
            font-family: 'Fredoka One', cursive;
            color: #FF6347;
            margin-bottom: 25px;
            font-size: 2.8em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        /* Gaya untuk halaman Instruksi */
        #instructionScreen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .instruction-title {
            font-family: 'Fredoka One', cursive;
            color: #1E90FF;
            font-size: 2.5em;
            margin-bottom: 20px;
        }
        .instruction-content {
            font-family: 'Open Sans', sans-serif;
            font-size: 1.2em;
            color: #555;
            line-height: 1.6;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .volume-control {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            gap: 5px;
            z-index: 10;
        }

        .volume-control label {
            font-family: 'Fredoka One', cursive;
            font-size: 1.1em;
            color: #555;
        }

        .volume-control input[type="range"] {
            -webkit-appearance: none;
            width: 100px;
            height: 8px;
            background: #ddd;
            border-radius: 5px;
            outline: none;
            transition: opacity .2s;
        }

        .volume-control input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4CAF50;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .volume-control input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4CAF50;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .current-question-info {
            font-family: 'Fredoka One', cursive;
            font-size: 1.2em;
            color: #4CAF50;
            margin-bottom: 10px;
        }

        .score-display {
            font-family: 'Fredoka One', cursive;
            font-size: 1.5em;
            color: #4CAF50;
            margin-bottom: 20px;
        }

        .question-mark-display {
            font-size: 8em;
            background-color: #333;
            color: white;
            border-radius: 50%;
            width: 1.5em;
            height: 1.5em;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 30px auto;
            cursor: pointer;
            transition: transform 0.2s ease-in-out;
            animation: pulse 1.5s infinite alternate;
            line-height: 1;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.05); }
        }

        .question-mark-display:hover {
            transform: scale(1.1);
        }

        .instructions-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 25px;
            gap: 10px;
        }

        .instructions-text {
            font-style: italic;
            color: #555;
            font-size: 1.1em;
            margin: 0;
        }

        .instruction-button {
            background-color: #1E90FF;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .instruction-button:hover {
            background-color: #007BFF;
            transform: scale(1.05);
        }

        .instruction-button:active {
            transform: scale(0.95);
        }

        .choices-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 15px;
            margin-top: 20px;
            margin-bottom: 20px;
        }

        .choice-button {
            background-color: #87CEEB;
            color: white;
            padding: 15px 10px;
            border: none;
            border-radius: 15px;
            font-size: 3em;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease-in-out, transform 0.1s ease-in-out, box-shadow 0.3s ease-in-out;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
            font-family: 'Fredoka One', cursive;
            letter-spacing: 1px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .choice-button:hover {
            background-color: #6495ED;
            transform: translateY(-3px);
        }

        .choice-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .choice-button.correct-feedback {
            background-color: #4CAF50;
            animation: correctPulse 0.5s forwards;
        }

        .choice-button.wrong-feedback {
            background-color: #F44336;
            animation: wrongShake 0.5s forwards;
        }

        @keyframes correctPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes wrongShake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        #feedback {
            margin-top: 25px;
            font-size: 1.5em;
            font-weight: bold;
            min-height: 1.8em;
            transition: opacity 0.3s ease-in-out;
        }

        /* Gaya untuk pesan GAME SELESAI */
        .game-over-message {
            font-family: 'Fredoka One', cursive;
            color: #FF6347;
            font-size: 3.5em;
            margin-top: 50px;
            text-shadow: 3px 3px 5px rgba(0, 0, 0, 0.15);
            animation: fadeInScale 1s ease-out forwards;
        }

        /* Gaya untuk teks Skor Akhir */
        .final-score-text {
            font-family: 'Fredoka One', cursive;
            color: #4CAF50;
            font-size: 1.8em;
            margin-top: 20px;
            margin-bottom: 30px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
        }

        @keyframes fadeInScale {
            0% { opacity: 0; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1); }
        }

        .main-button {
            background-color: #4CAF50;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.5em;
            font-family: 'Fredoka One', cursive;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
        }

        .main-button:hover {
            background-color: #45a049;
            transform: translateY(-3px);
        }

        .main-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        /* --- Gaya untuk Cara Membaca --- */
        #factsScreen {
            display: none;
            padding: 20px;
            text-align: left;
            max-height: 70vh;
            overflow-y: auto;
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        #factsScreen::-webkit-scrollbar {
            display: none;
        }

        .facts-title {
            font-family: 'Fredoka One', cursive;
            color: #FF6347;
            font-size: 2.5em;
            margin-bottom: 25px;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .fact-item {
            margin-bottom: 20px;
            border-bottom: 1px dashed #ccc;
            padding-bottom: 15px;
        }

        .fact-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .fact-item h3 {
            font-family: 'Fredoka One', cursive;
            color: #1E90FF;
            font-size: 1.6em;
            margin-top: 0;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .fact-speaker-button {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 0;
            line-height: 1;
            margin-left: 5px;
            transition: transform 0.1s ease-in-out;
        }

        .fact-speaker-button:hover {
            transform: scale(1.1);
        }

        .fact-speaker-button:active {
            transform: scale(0.9);
        }

        .fact-item p {
            font-family: 'Open Sans', sans-serif;
            font-size: 1.1em;
            line-height: 1.6;
            color: #444;
            text-align: justify;
        }

        .fact-navigation {
            margin-top: 30px;
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        /* Gaya untuk tombol navigasi emoji */
        .fact-navigation .emoji-button {
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 50%; /* Membuat tombol menjadi lingkaran */
            font-size: 2em; /* Ukuran emoji */
            width: 60px; /* Ukuran tombol (sesuaikan) */
            height: 60px; /* Ukuran tombol (sesuaikan) */
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
            font-family: 'Fredoka One', cursive;
        }

        .fact-navigation .emoji-button:hover {
            background-color: #45a049;
            transform: translateY(-3-px);
        }

        .fact-navigation .emoji-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        /* --- Gaya untuk Watermark Kredit (diperbarui) --- */
        .credit-watermark {
            display: none;
            position: fixed;
            bottom: 20px;
            left: 20px;
            transform: none;
            z-index: 1000;
        }

        .credit-watermark.show-on-instruction {
            display: block;
        }
        
        /* Gaya baru untuk Kartu Kontak */
        .contact-card {
            background-color: rgba(255, 255, 255, 0.85);
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            display: flex;
            flex-direction: column;
            gap: 5px;
            text-align: left;
            font-family: 'Open Sans', sans-serif;
            color: #333;
        }
        
        .contact-card p {
            margin: 0;
            font-size: 0.9em;
            line-height: 1.2;
        }

        .contact-card .contact-link {
            color: #007BFF;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s ease;
        }

        .contact-card .contact-link:hover {
            color: #0056b3;
        }

        /* Responsif untuk layar kecil */
        @media (max-width: 768px) {
            .credit-watermark {
                bottom: 10px;
                left: 10px;
            }
            .fact-navigation .emoji-button {
                width: 50px;
                height: 50px;
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="volume-control">
            <label for="volumeSlider">Musik:</label>
            <input type="range" id="volumeSlider" min="0" max="1" step="0.01" value="0.5">
        </div>

        <div id="instructionScreen">
            <h1 class="instruction-title">Tebak Suara Huruf!üî†‚ú¥Ô∏è</h1>
            <div class="instruction-content">
                <p>Selamat datang di permainan "Tebak Suara Huruf"! ü•≥</p>
                <p>Tugas kamu adalah mendengarkan suara yang keluar, lalu menebak huruf mana yang tepat.</p>
            </div>
            <button class="main-button" id="startButton">MULAI</button>
        </div>

        <div id="gameScreen" style="display: none;">
            <h1>Tebak Suara Huruf!üî†‚ú¥Ô∏è</h1>
            <div class="current-question-info" id="questionInfo">Pertanyaan 1 dari 26</div>
            <div class="score-display">Skor: <span id="score">0</span></div>
            <div class="question-mark-display" id="questionMarkDisplay">?</div>
            
            <div class="instructions-container">
                <p class="instructions-text" id="instructionsText">Klik tanda tanya untuk mendengar suaranya. Lalu, pilih huruf yang benar!</p>
                <button class="instruction-button" id="playInstructionSound">üîä</button>
            </div>
            
            <div class="choices-container" id="choicesContainer">
            </div>
            <div id="feedback"></div>
        </div>

        <div id="gameOverScreen" style="display: none;">
            <div class="game-over-message" id="gameOverText">GAME SELESAI</div>
            <div class="final-score-text" id="finalScoreText"></div>
            <button class="main-button" id="showFactsButton">CARA MEMBACA</button>
        </div>

        <div id="factsScreen" style="display: none;">
            <h2 class="facts-title">CARA MEMBACA üìñ</h2>
            <div id="factsContent">
            </div>
            <div class="fact-navigation">
                <button class="emoji-button" id="previousFactButton" style="display: none;">‚¨ÖÔ∏è</button>
                <button class="emoji-button" id="nextFactButton" style="display: none;">‚û°Ô∏è</button>
                <button class="emoji-button" id="playAgainButton" style="display: none;">üîÑ</button>
            </div>
        </div>
    </div>
    
    <div class="credit-watermark show-on-instruction" id="creditWatermark">
        <div class="contact-card">
            <p>Created on: GlowandGrow</p>
            <p>Contact person: 
                <a href="https://wa.me/6289629065679" class="contact-link" target="_blank">+6289629065679 / Rahma</a>
            </p>
        </div>
    </div>

    <audio id="backgroundMusic" loop></audio>
    <audio id="gameSound"></audio>
    <audio id="feedbackSound"></audio>
    <audio id="clickEffectSound"></audio>
    <audio id="correctLetterSound"></audio>
    <audio id="factSoundPlayer"></audio>

    <script>
        // ====================================================================
        // PANDUAN PEMELIHARAAN KODE
        // ====================================================================

        // --- 1. MENAMBAH/MENGUBAH HURUF (PERTANYAAN) DAN CARA MEMBACA ---
        // PENTING: Anda harus menyiapkan file .mp3 di folder 'assets/audio/'
        // Contoh: assets/audio/ini_bola_saya.mp3, dst.
        const sentences = [
            { name: "a", sound: "assets/audio/a.mp3", correctSound: "assets/audio/yabenar_a.mp3", sentence: "INI BOLA SAYA", sentenceSound: "assets/audio/ini_bola_saya.mp3" },
            { name: "b", sound: "assets/audio/b.mp3", correctSound: "assets/audio/yabenar_b.mp3", sentence: "BUDI SEDANG MAKAN", sentenceSound: "assets/audio/budi_sedang_makan.mp3" },
            { name: "c", sound: "assets/audio/c.mp3", correctSound: "assets/audio/yabenar_c.mp3", sentence: "AYAH BELI DURIAN", sentenceSound: "assets/audio/ayah_beli_durian.mp3" },
            { name: "d", sound: "assets/audio/d.mp3", correctSound: "assets/audio/yabenar_d.mp3", sentence: "MATA SAYA SAKIT", sentenceSound: "assets/audio/mata_saya_sakit.mp3" },
            { name: "e", sound: "assets/audio/e.mp3", correctSound: "assets/audio/yabenar_e.mp3", sentence: "KITA BISA LARI", sentenceSound: "assets/audio/kita_bisa_lari.mp3" },
            { name: "f", sound: "assets/audio/f.mp3", correctSound: "assets/audio/yabenar_f.mp3", sentence: "RUMAH SAYA KECIL", sentenceSound: "assets/audio/rumah_saya_kecil.mp3" },
            { name: "g", sound: "assets/audio/g.mp3", correctSound: "assets/audio/yabenar_g.mp3", sentence: "KAKA RAJIN SEKALI", sentenceSound: "assets/audio/kaka_rajin_sekali.mp3" },
            { name: "h", sound: "assets/audio/h.mp3", correctSound: "assets/audio/yabenar_h.mp3", sentence: "AYAM ITU LUCU", sentenceSound: "assets/audio/ayam_itu_lucu.mp3" },
            { name: "i", sound: "assets/audio/i.mp3", correctSound: "assets/audio/yabenar_i.mp3", sentence: "MAKAN NASI BARENG", sentenceSound: "assets/audio/makan_nasi_bareng.mp3" },
            { name: "j", sound: "assets/audio/j.mp3", correctSound: "assets/audio/yabenar_j.mp3", sentence: "AIRNYA SANGAT JERNIH", sentenceSound: "assets/audio/airnya_sangat_jernih.mp3" },
            { name: "k", sound: "assets/audio/k.mp3", correctSound: "assets/audio/yabenar_k.mp3", sentence: "IKAN ADALAH HEWAN", sentenceSound: "assets/audio/ikan_adalah_hewan.mp3" },
            { name: "l", sound: "assets/audio/l.mp3", correctSound: "assets/audio/yabenar_l.mp3", sentence: "LAMPU ITU TERANG", sentenceSound: "assets/audio/lampu_itu_terang.mp3" },
            { name: "m", sound: "assets/audio/m.mp3", correctSound: "assets/audio/yabenar_m.mp3", sentence: "MARI KITA MAIN", sentenceSound: "assets/audio/mari_kita_main.mp3" },
            { name: "n", sound: "assets/audio/n.mp3", correctSound: "assets/audio/yabenar_n.mp3", sentence: "NONA PAKAI BAJU", sentenceSound: "assets/audio/nona_pakai_baju.mp3" },
            { name: "o", sound: "assets/audio/o.mp3", correctSound: "assets/audio/yabenar_o.mp3", sentence: "ORANG ITU BAIK", sentenceSound: "assets/audio/orang_itu_baik.mp3" },
            { name: "p", sound: "assets/audio/p.mp3", correctSound: "assets/audio/yabenar_p.mp3", sentence: "PAPA BELI ROTI", sentenceSound: "assets/audio/papa_beli_roti.mp3" },
            { name: "q", sound: "assets/audio/q.mp3", correctSound: "assets/audio/yabenar_q.mp3", sentence: "QUOTIENT ADALAH HASIL", sentenceSound: "assets/audio/quotient_adalah_hasil.mp3" },
            { name: "r", sound: "assets/audio/r.mp3", correctSound: "assets/audio/yabenar_r.mp3", sentence: "RAMBUT SAYA HITAM", sentenceSound: "assets/audio/rambut_saya_hitam.mp3" },
            { name: "s", sound: "assets/audio/s.mp3", correctSound: "assets/audio/yabenar_s.mp3", sentence: "SAKIT KEPALA SAYA", sentenceSound: "assets/audio/sakit_kepala_saya.mp3" },
            { name: "t", sound: "assets/audio/t.mp3", correctSound: "assets/audio/yabenar_t.mp3", sentence: "TANAH ITU SUBUR", sentenceSound: "assets/audio/tanah_itu_subur.mp3" },
            { name: "u", sound: "assets/audio/u.mp3", correctSound: "assets/audio/yabenar_u.mp3", sentence: "ULAR ITU PANJANG", sentenceSound: "assets/audio/ular_itu_panjang.mp3" },
            { name: "v", sound: "assets/audio/v.mp3", correctSound: "assets/audio/yabenar_v.mp3", sentence: "VIDEO INI BAGUS", sentenceSound: "assets/audio/video_ini_bagus.mp3" },
            { name: "w", sound: "assets/audio/w.mp3", correctSound: "assets/audio/yabenar_w.mp3", sentence: "WARNA ITU CERAH", sentenceSound: "assets/audio/warna_itu_cerah.mp3" },
            { name: "x", sound: "assets/audio/x.mp3", correctSound: "assets/audio/yabenar_x.mp3", sentence: "XILOFON ADALAH ALAT", sentenceSound: "assets/audio/xilofon_adalah_alat.mp3" },
            { name: "y", sound: "assets/audio/y.mp3", correctSound: "assets/audio/yabenar_y.mp3", sentence: "YA SAYA SUKA", sentenceSound: "assets/audio/ya_saya_suka.mp3" },
            { name: "z", sound: "assets/audio/z.mp3", correctSound: "assets/audio/yabenar_z.mp3", sentence: "ZAINAB SEDANG MENANGIS", sentenceSound: "assets/audio/zainab_sedang_menangis.mp3" }
        ];

        // --- 2. MENGATUR JALUR SUARA GAME UTAMA DAN UMPAN BALIK ---
        const gameSounds = {
            backgroundMusic: "assets/audio/background_music.mp3",
            clickEffect: "assets/audio/click.mp3",
            instruction: "assets/audio/instruksi_tebak_suara_huruf.mp3",
            correctFeedback: "assets/audio/benar_sekali.mp3",
            wrongFeedback: "assets/audio/coba_lagi.mp3",
        };

        // --- 3. PENGATURAN DURASI SUARA DAN JEDA ---
        const LETTER_SOUND_DURATION = 1500;
        const DELAY_AFTER_FEEDBACK = 4000;
        const CLICK_EFFECT_DELAY = 500;
        const FACTS_PER_PAGE = 3; // Menampilkan 3 kalimat per halaman

        // Variabel Status Game
        let currentQuestionIndex = 0;
        let score = 0;
        let choicesEnabled = true;
        let answeredQuestions = [];
        let shuffledSentences = [];
        let currentSentencePageIndex = 0;

        // Referensi Elemen HTML
        const instructionScreenEl = document.getElementById('instructionScreen');
        const startButton = document.getElementById('startButton');
        const questionMarkDisplayEl = document.getElementById('questionMarkDisplay');
        const backgroundMusicEl = document.getElementById('backgroundMusic');
        const gameSoundEl = document.getElementById('gameSound');
        const feedbackSoundEl = document.getElementById('feedbackSound');
        const clickEffectSoundEl = document.getElementById('clickEffectSound');
        const volumeSliderEl = document.getElementById('volumeSlider');
        const feedbackEl = document.getElementById('feedback');
        const scoreEl = document.getElementById('score');
        const choicesContainerEl = document.getElementById('choicesContainer');
        const instructionsTextEl = document.getElementById('instructionsText');
        const playInstructionSoundBtn = document.getElementById('playInstructionSound');
        const questionInfoEl = document.getElementById('questionInfo');
        const gameScreenEl = document.getElementById('gameScreen');
        const gameOverScreenEl = document.getElementById('gameOverScreen');
        const gameOverTextEl = document.getElementById('gameOverText');
        const finalScoreTextEl = document.getElementById('finalScoreText');
        const showFactsButton = document.getElementById('showFactsButton');
        const factsScreenEl = document.getElementById('factsScreen');
        const factsContentEl = document.getElementById('factsContent');
        const previousFactButton = document.getElementById('previousFactButton');
        const nextFactButton = document.getElementById('nextFactButton');
        const playAgainButton = document.getElementById('playAgainButton');
        const correctLetterSoundEl = document.getElementById('correctLetterSound');
        const factSoundPlayerEl = document.getElementById('factSoundPlayer');
        const creditWatermarkEl = document.getElementById('creditWatermark');


        // Fungsi Utilitas
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function loadNewQuestion() {
            if (currentQuestionIndex >= answeredQuestions.length) {
                displayGameCompleted();
                return;
            }

            choicesEnabled = true;
            feedbackEl.textContent = '';
            feedbackEl.className = '';

            const currentLetter = answeredQuestions[currentQuestionIndex];
            questionMarkDisplayEl.textContent = '?';
            
            questionInfoEl.textContent = `Pertanyaan ${currentQuestionIndex + 1} dari ${answeredQuestions.length}`;

            generateChoices(currentLetter);
        }

        function generateChoices(correctLetter) {
            choicesContainerEl.innerHTML = '';

            let choiceLetters = sentences.filter(a => a.name !== correctLetter.name);
            shuffleArray(choiceLetters);

            const selectedWrongChoices = choiceLetters.slice(0, Math.min(3, sentences.length - 1));
            
            let choices = [...selectedWrongChoices, correctLetter];
            shuffleArray(choices);

            choices.forEach(letter => {
                const button = document.createElement('button');
                button.textContent = letter.name.toUpperCase();
                button.classList.add('choice-button');
                button.onclick = () => checkAnswer(letter, correctLetter, button);
                choicesContainerEl.appendChild(button);
            });
        }

        function playLetterSoundWithEffect() {
            clickEffectSoundEl.src = gameSounds.clickEffect;
            clickEffectSoundEl.play().catch(e => console.error("Error playing click sound:", e));

            questionMarkDisplayEl.style.transform = 'scale(1.1)';
            setTimeout(() => questionMarkDisplayEl.style.transform = 'scale(1)', 200);

            setTimeout(() => {
                const currentLetter = answeredQuestions[currentQuestionIndex];
                gameSoundEl.src = currentLetter.sound;
                gameSoundEl.play().catch(e => console.error("Error playing letter sound:", e));

                setTimeout(() => {
                    gameSoundEl.pause();
                    gameSoundEl.currentTime = 0;
                }, LETTER_SOUND_DURATION);
            }, CLICK_EFFECT_DELAY);
        }

        async function checkAnswer(selectedLetter, correctLetter, clickedButton) {
            if (!choicesEnabled) return;

            choicesEnabled = false;

            const allButtons = choicesContainerEl.querySelectorAll('.choice-button');
            allButtons.forEach(btn => {
                btn.classList.remove('correct-feedback', 'wrong-feedback');
            });

            if (selectedLetter.name === correctLetter.name) {
                feedbackEl.textContent = 'Benar! üéâ';
                feedbackEl.classList.add('correct');
                
                correctLetterSoundEl.src = correctLetter.correctSound;
                await correctLetterSoundEl.play().catch(e => console.error("Error playing correct letter sound:", e));

                feedbackSoundEl.src = gameSounds.correctFeedback;
                await feedbackSoundEl.play().catch(e => console.error("Error playing correct feedback sound:", e));
                
                clickedButton.classList.add('correct-feedback');
                score++;
                scoreEl.textContent = score;
                currentQuestionIndex++;

                setTimeout(() => {
                    loadNewQuestion();
                }, DELAY_AFTER_FEEDBACK);
            } else {
                feedbackEl.textContent = `Salah. Jawaban yang benar adalah ${correctLetter.name.toUpperCase()}. üòû`;
                feedbackEl.classList.add('wrong');
                feedbackSoundEl.src = gameSounds.wrongFeedback;
                await feedbackSoundEl.play().catch(e => console.error("Error playing wrong feedback sound:", e));
                clickedButton.classList.add('wrong-feedback');

                allButtons.forEach(btn => {
                    if (btn.textContent.toLowerCase() === correctLetter.name) {
                        btn.classList.add('correct-feedback');
                    }
                });
                currentQuestionIndex++;

                setTimeout(() => {
                    loadNewQuestion();
                }, DELAY_AFTER_FEEDBACK);
            }
        }

        function displayGameCompleted() {
            gameScreenEl.style.display = 'none';
            gameOverScreenEl.style.display = 'block';
            
            finalScoreTextEl.textContent = `Skor kamu ${score} dari ${sentences.length} soal`;
            
            shuffledSentences = shuffleArray(sentences.filter(s => s.sentence && s.sentenceSound));
            currentSentencePageIndex = 0;
            
            creditWatermarkEl.classList.add('show-on-instruction');
        }

        function showFacts() {
            gameOverScreenEl.style.display = 'none';
            factsScreenEl.style.display = 'block';
            
            backgroundMusicEl.play().catch(e => console.error("Failed to play background music on facts screen:", e));

            loadFactsPage();
        }

        function loadFactsPage() {
            factsContentEl.innerHTML = '';
            
            const startIndex = currentSentencePageIndex * FACTS_PER_PAGE;
            const endIndex = Math.min(startIndex + FACTS_PER_PAGE, shuffledSentences.length);
            
            for (let i = startIndex; i < endIndex; i++) {
                const sentence = shuffledSentences[i];
                const sentenceDiv = document.createElement('div');
                sentenceDiv.classList.add('fact-item');
                sentenceDiv.innerHTML = `
                    <h3>
                        ${i + 1}. ${sentence.sentence.toUpperCase()}
                        <button class="fact-speaker-button" data-sound-src="${sentence.sentenceSound}">üîä</button>
                    </h3>
                `;
                factsContentEl.appendChild(sentenceDiv);
            }

            factsContentEl.querySelectorAll('.fact-speaker-button').forEach(button => {
                button.addEventListener('click', (event) => {
                    const soundSrc = event.target.dataset.soundSrc;
                    playSentenceSound(soundSrc);
                });
            });

            if (currentSentencePageIndex > 0) {
                previousFactButton.style.display = 'inline-flex';
            } else {
                previousFactButton.style.display = 'none';
            }

            if (endIndex < shuffledSentences.length) {
                nextFactButton.style.display = 'inline-flex';
                playAgainButton.style.display = 'none';
            } else {
                nextFactButton.style.display = 'none';
                playAgainButton.style.display = 'inline-flex';
            }
            
            factsScreenEl.scrollTop = 0;
        }

        function nextFacts() {
            currentSentencePageIndex++;
            loadFactsPage();
        }

        function previousFacts() {
            currentSentencePageIndex--;
            if (currentSentencePageIndex < 0) {
                currentSentencePageIndex = 0;
            }
            loadFactsPage();
        }

        function playAgain() {
            factsScreenEl.style.display = 'none';
            score = 0;
            scoreEl.textContent = score;
            currentQuestionIndex = 0;
            answeredQuestions = shuffleArray([...sentences]);
            gameScreenEl.style.display = 'block';
            
            choicesContainerEl.style.display = 'grid';
            questionMarkDisplayEl.style.display = 'flex';
            instructionsTextEl.style.display = 'inline';
            playInstructionSoundBtn.style.display = 'inline-block';
            feedbackEl.innerHTML = '';
            
            backgroundMusicEl.play().catch(e => {
                console.error("Autoplay of background music failed on playAgain:", e);
            });
            
            creditWatermarkEl.classList.remove('show-on-instruction');
            
            loadNewQuestion();
        }

        function playSentenceSound(soundSrc) {
            if (!factSoundPlayerEl.paused) {
                factSoundPlayerEl.pause();
                factSoundPlayerEl.currentTime = 0;
            }
            factSoundPlayerEl.src = soundSrc;
            factSoundPlayerEl.play().catch(e => console.error("Error playing sentence sound:", e));
        }

        // Fungsi baru untuk memulai permainan
        function startGame() {
            instructionScreenEl.style.display = 'none';
            gameScreenEl.style.display = 'block';
            creditWatermarkEl.classList.remove('show-on-instruction');
            answeredQuestions = shuffleArray([...sentences]);
            loadNewQuestion();
        }


        // Event listeners
        questionMarkDisplayEl.addEventListener('click', playLetterSoundWithEffect);
        volumeSliderEl.addEventListener('input', (event) => {
            const sliderValue = event.target.value;
            // Musik latar diatur ke volume sangat kecil
            backgroundMusicEl.volume = sliderValue * 0.05;
            
            // Suara game lainnya mengikuti nilai slider
            gameSoundEl.volume = sliderValue;
            feedbackSoundEl.volume = sliderValue;
            clickEffectSoundEl.volume = sliderValue;
            correctLetterSoundEl.volume = sliderValue;
            factSoundPlayerEl.volume = sliderValue;
        });
        playInstructionSoundBtn.addEventListener('click', playInstructionSound);
        showFactsButton.addEventListener('click', showFacts);
        previousFactButton.addEventListener('click', previousFacts);
        nextFactButton.addEventListener('click', nextFacts);
        playAgainButton.addEventListener('click', playAgain);
        startButton.addEventListener('click', startGame);


        // =========================================================
        // PENGATURAN AWAL GAME (Penting untuk Autoplay Musik)
        // =========================================================

        function tryPlayBackgroundMusic() {
            backgroundMusicEl.src = gameSounds.backgroundMusic;
            
            // Mengatur volume musik latar ke nilai awal yang kecil
            backgroundMusicEl.volume = 0.05; 
            
            // Mengatur nilai awal slider dan volume audio lainnya
            volumeSliderEl.value = 0.5; // Mengatur slider ke tengah-tengah
            gameSoundEl.volume = volumeSliderEl.value;
            feedbackSoundEl.volume = volumeSliderEl.value;
            clickEffectSoundEl.volume = volumeSliderEl.value;
            correctLetterSoundEl.volume = volumeSliderEl.value;
            factSoundPlayerEl.volume = volumeSliderEl.value;
            

            backgroundMusicEl.play().catch(e => {
                console.error("Autoplay of background music failed:", e);
                document.body.addEventListener('click', enableBackgroundMusic, { once: true });
                document.body.addEventListener('touchend', enableBackgroundMusic, { once: true });
            });
        }

        function enableBackgroundMusic() {
            if (backgroundMusicEl.paused) {
                backgroundMusicEl.play().catch(e => {
                    console.error("Failed to play background music on user interaction:", e);
                });
            }
            document.body.removeEventListener('click', enableBackgroundMusic);
            document.body.removeEventListener('touchend', enableBackgroundMusic);
        }

        // --- MENGATUR TOMBOL SUARA INSTRUKSI ---
        function playInstructionSound() {
            gameSoundEl.src = gameSounds.instruction;
            gameSoundEl.play().catch(e => console.error("Error playing instruction sound:", e));
        }

        // Inisialisasi game saat halaman dimuat
        document.addEventListener('DOMContentLoaded', () => {
            tryPlayBackgroundMusic();
        });
    </script>
</body>
</html>

